{# This component will request a remote resource and then insert it as a child into the DOM #}
{% macro SVGPattern(url, id) %}
    <div class="ngwmn-component" data-component="svg-pattern" data-url="{{ url }}" data-id="{{ id }}"></div>
{%- endmacro %}

{% macro LithologyPatterns(lithology_ids) -%}
    {# Insert lithology pattern defs #}
    {% for lith_id in lithology_ids %}
        {{ SVGPattern(('patterns/' ~ lith_id ~ '.svg') | asset_url, 'lithology-' ~ lith_id) }}
    {% endfor %}
{%- endmacro %}

{% macro Graph(agency_code, site_no) -%}
    <div class="has-script">
        <div class="ngwmn-component loading" data-component="graph" data-site-id="{{ site_no }}" data-agency-code="{{ agency_code }}">
            <div class="indicators">
                <i class="loading-indicator fas fa-5x fa-spin fa-spinner"></i>
                <i class="error-indicator fas fa-5x fa-exclamation-circle"></i>
            </div>
        </div>
    </div>
    <noscript>
        <div class="usa-alert usa-alert-warning">
            <div class="usa-alert-body">
                <h3 class="usa-alert-heading">Warning</h3>
                <p class="usa-alert-text">Javascript is required to view the interactive water-level graph.</p>
            </div>
        </div>
    </noscript>
{%- endmacro %}

{% macro _(value, default='-') -%}
    {{ value if value is not none else default }}
{%- endmacro %}

{% macro WellLog(agency_code, site_no, well_log) -%}
    <div class="ngwmn-component" data-component="well-log" data-site-id="{{ site_no }}" data-agency-code="{{ agency_code }}">
        <h3>Well Construction</h3>
        <input type="radio" name="construction-type" value="all" id="all" checked>
        <label for="all">All</label>
        <input type="radio" name="construction-type" value="screens" id="screens">
        <label for="screens">Screens</label>
        <input type="radio" name="construction-type" value="casings" id="casings">
        <label for="casings">Casings</label>
        <table class="usa-table-borderless">
            <thead>
                <tr>
                    <th scope="col"></th>
                    <th scope="col">Depth</th>
                    <th scope="col">Description</th>
                </tr>
            </thead>
            <tbody>
                {% for item in well_log.construction %}
                    <tr class="{{ item.type }}" data-local-id="{{ item.id }}">
                        <td>
                            {% if item.type == 'screen' %}
                                <svg width="30" height="30" viewBox="0 0 30 30">
                                    <rect width="30" height="30" fill="url(#screen-pattern-{{ loop.index0 % 2 }})" />
                                </svg>
                            {% else %}
                                <svg width="30" height="30" viewBox="0 0 30 30">
                                    <line x1="15" y1="0" x2="15" y2="30" stroke-width="2" stroke="gray" />
                                </svg>
                            {% endif %}
                        </td>
                        <td>{{ item.position.coordinates.start }}-{{ item.position.coordinates.end }} {{ item.position.unit }}</td>
                        <td>
                            {% if item.diameter.value %}
                                {{ item.diameter.value }} {{ item.diameter.unit }} diameter
                            {% endif %}
                            {% if item.material != 'Screen, Type Not Known' %}
                                {{ item.material | lower() }}
                            {% endif %}
                            {{ item.type | lower() }}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{%- endmacro %}

{% macro WaterLevelTable(agency_code, site_no) -%}
<li class="ngwmn-component" data-component="water-level-table" data-site-id="{{ site_no }}" data-agency-code="{{ agency_code }}">
    <button class="usa-accordion-button" aria-expanded="false" aria-controls="water-levels-div">
        Water Levels
    </button>
    <div id="water-levels-div" class="usa-accordion-content">
    </div>
</li>
{%- endmacro %}
